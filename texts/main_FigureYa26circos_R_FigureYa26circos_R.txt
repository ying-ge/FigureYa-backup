FigureYa26circos_R
FigureYa26circos_R
Author(s)
: Zhaodong Hao; Ying Ge, Yijing Chen
Date
: 2025-10-04
Academic Citation
If you use this code in your work or research, we kindly request that
you cite our publication:
Xiaofan Lu, et al. (2025). FigureYa: A Standardized Visualization
Framework for Enhancing Biomedical Data Interpretation and Research
Efficiency. iMetaMed.
https://doi.org/10.1002/imm3.70005
If you use circlize in published research, please cite:
Gu, Z. circlize implements and enhances circular visualization in R.
Bioinformatics 2014.
需求描述
Requirement description
用R代码画出paper里的图。
Use R code to draw the plot in paper.
图2
各状态的聚类分析结果。图中只显示了每个状态下功能连接矩阵的
5%，代表最强的连接（即绝对值最大的相关系数）。每个方块的颜色代表七个网络中的一个。红线表示
正功能连接
，蓝线表示
负功能连接
。BG
= 基底神经节；AUD = 听觉；SMN = 感觉运动；VIS = 视觉；CEN = 认知执行；CB
= 小脑网络。
Figure 2
Results of the clustering analysis per
state. Only 5% of the functional connectivity matrix in each state is
shown, representing the strongest connections (i.e. the largest absolute
value correlation coefficients). Each square colour represents one of
the seven networks. Red lines represent
positive functional
connectivity
, and blue lines represent
negative
functional connectivity
. BG = basal ganglia; AUD = auditory;
SMN = sensorimotor; VIS = visual; CEN = cognitive executive; CB =
cerebellar network
出自
https://academic.oup.com/brain/article-lookup/doi/10.1093/brain/awx233
from
https://academic.oup.com/brain/article-lookup/doi/10.1093/brain/awx233
应用场景
Application scenario
如果展示A-B-C之间的关系，用sankey图就够了，见FigureYa25sankey。
如果还要展示A-C的关系，直线排列的sankey图就不适合了。
本图用圆圈和连线展示多个亚组之间的关系，包括且不限于基因、基因片段、亚型。
场景一：展示基因融合（fusion），同一个基因的多个片段用同一种颜色，用线把不同基因间融合的片段连接起来。常见于肿瘤基因组DNA测序数据。
场景二：像例图那样，同一组基因用相同的颜色展示，基因间的正、负调控关系用两种颜色的线展示，组间的调控关系一目了然。
If the relationship among A-B-C is to be shown, a sankey diagram is
sufficient, see FigureYa25sankey.
If the relationship between A and C needs to be shown, a
straight-line Sankey diagram is not suitable.
This diagram uses circles and connecting lines to show relationships
between multiple subgroups, including and not limited to genes, gene
fragments, and subtypes.
Scenario 1: Demonstrate gene fusion (fusion), where multiple
fragments of the same gene are in the same color, and lines are used to
connect the fused fragments between different genes. Commonly seen in
tumor genome DNA sequencing data.
Scenario 2: As in the example diagram, the same group of genes is
displayed in the same color, and the positive and negative regulatory
relationships between genes are displayed with lines of two colors, so
that the regulatory relationships between groups can be seen at a
glance.
环境设置
Environment Setup
source("install_dependencies.R")
library(stringi)
library(circlize)
library(graphics)

# 显示英文报错信息
# Show English error messages
Sys.setenv(LANGUAGE = "en") 

# 禁止chr转成factor
# Prevent character-to-factor conversion
options(stringsAsFactors = FALSE)
输入文件
Input file
需要三个文件：
Gene_ID.txt，组，此处一个Gene为一组；
Gene_feature.txt，亚组，Gene内包含多个Subgroup；
Links.txt，Subgroup之间的inks。
如果你要突出显示某个基因或某条连线，在输入文件中找到相应的行，修改颜色或高度即可。
Three files are needed:
Gene_ID.txt, groups, here a Gene is a group;
Gene_feature.txt, subgroups, multiple Subgroups contained within
a Gene;
Links.txt, links between Subgroups.
If you want to highlight a gene or a link, find the corresponding
line in the input file and change the color or height.
#组ID、组的起止位置
#Group ID, start and end positions of the group
GeneID <- read.table("Gene_ID.txt", header = TRUE, sep = "\t")
head(GeneID)
#亚组的名字和起止位置，至少要有前四列
#最后一列颜色为可选项，可以在输入文件中写好，也可以在后面的代码中指定
#the name and starting and ending positions of the subgroups, at least the first four columns
#the last column color is optional and can be written in the input file or specified later in the code
GeneFe <- read.table("Gene_feature.txt", header = TRUE, sep = "\t")
head(GeneFe)
#哪两个亚组之间要画连线、线在亚组上的相对位置，至少要有前四列
#后两列颜色“link_col”和高度“link_height”为可选项，可以在输入文件中写好，也可以在后面的代码中指定
#which two subgroups should be connected with a line, and the relative position of the line on the subgroups, with at least the first four columns.
#the color “link_col” and the height “link_height” of the last two columns are optional, they can be written in the input file or specified in the code behind.
Links <- read.table("Links.txt", header = TRUE, sep = "\t")
head(Links)
# 把组ID转换成factor，因为后面画图需要factor
# convert the group ID to a factor, because you'll need the factor to draw the graph later
GeneID$GeneID <- factor(GeneID$GeneID, levels = GeneID$GeneID)
开始画图
Start drawing
注意：
如果你用复制粘贴代码的方式运行，需要从pdf到dev.off之间的语句要一次性全部复制。
Note:
If you run it by copying and pasting the code,
you need to copy all the statements between pdf and dev.off at once.
sessionInfo()