FigureYa309cell2location
FigureYa309cell2location
小丫画图出品
2023-3-24
欢迎关注“小丫画图”公众号，回复“小白”，看小视频，实现点鼠标跑代码。
小丫微信: epigenomics E-mail:
figureya@126.com
作者：Jarning，他的更多作品看这里
https://k.koudai.com/BXEtOldY
小丫编辑校验
需求描述
我想利用cell2location实现单细胞解析空间转录组中细胞的比例。
这个跟MIA不同，能够计算出每个空间位点中细胞亚型的比例，从而看各个细胞在空间中的交互作用。
FigureYa239ST_PDAC
https://k.youshop10.com/7Ols6b7-
用的是MIA，它只能计算细胞在这个区域的可能性。
它用的数据是比较老的，一个样本只有几百个点。
现在空转的数据都是几千个点，精度远高于它，所以这种方式已经不适用了。
Figure 6. RCC cell expression programs, regional enrichment, and
prognosis (F) Spatial mapping of EMT and PT tumor cells in a
representative tumor-normal interface sample (PD47171) using
cell2location. Estimated abundance (color intensity) is overlaid on a
histology image. Scale bars, 1 mm.
Figure 7. Cellular interactions in the ccRCC microenvironment (B)
Spatial mapping of EMT tumor cells, PT tumor cells, and TR Mac.2 in
Visium data for representative tumor-normal interface (PD45816) and
tumor core (PD47171) samples using cell2location. Estimated abundance
for cell types (color intensity) across locations (dots) is overlaid on
histology images. Scale bars, 1 mm.
出自
https://linkinghub.elsevier.com/retrieve/pii/S1535610822005487
应用场景
用cell2location实现单细胞解析空间转录组中细胞的比例，这里复现了例文的Figure
6F，S5D，7B。
以后众筹更多空间转录组的美图，都放在这里
https://k.youshop10.com/vpaiQGgf
环境设置
下载并安装Anaconda发行版，
https://www.anaconda.com/distribution/#download-section
里面已经包含了运行本文档所需的Python3、ipython、Jupyter
notebook。
打开Anaconda——点击Jupyter
notebook——选择
01_explore_space_transcriptome.ipynb
打开，在Jupyter
Notebook中点击Run按钮，即可运行python代码。
cell2location的安装
参考：
https://github.com/BayraktarLab/cell2location#Installation
在终端Terminal运行以下命令
conda create -y -n cell2loc_env python=3.9
conda activate cell2loc_env
pip install cell2location[tutorials]
将该环境注入jupyter notebook
conda activate cell2loc_env
conda install ipykernel --yes
python -m ipykernel install --user --name=cell2loc_env --display-name='Environment (cell2loc_env)'
# OR
conda install nb_conda
输入文件
从Mendeley Data下载例文的输入文件：
https://data.mendeley.com/datasets/g67bkbnhhg/1
01_explore_space_transcriptome.ipynb
分析
02_cell2location_signature.ipynb
03_cell2location_mapping.ipynb
画图 - Figure 6F，S5D，7B
04_cell2location_plot.ipynb